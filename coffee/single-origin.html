<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Single Origin Coffee - Elevate Roasting</title>
  <meta name="description" content="Explore our single origin coffees from around the world. Each origin tells a unique story of terroir and tradition." />
  <link rel="icon" href="/favicon.ico" />
  <meta name="color-scheme" content="dark light" />
  
  <!-- Tailwind via CDN for fast prototyping. Replace with a build step later. -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Custom styles -->
  <link rel="stylesheet" href="../css/styles.css?v=3" />
</head>

<body class="antialiased theme-light">
  <!-- Site header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo">
          <img src="../assets/logos/logo_black.svg" alt="Elevate Roasting" class="logo-image" />
        </a>
        <nav class="nav" id="main-nav">
          <!-- Navigation items will be populated by JavaScript -->
        </nav>
      </div>
    </div>
  </header>

  <!-- Hero section -->
  <section class="section">
    <div class="container">
      <div class="text-center">
        <h1 class="hero-title text-heading mb-4">
          Single Origin Coffee
        </h1>
        <p class="hero-description text-body max-w-2xl mx-auto">
          Each coffee tells the story of its origin: the farm, the processing method, 
          the elevation, the varietal. We roast to highlight these unique characteristics.
        </p>
      </div>
    </div>
  </section>

  <!-- Coffee origins -->
  <section class="section section-divider">
    <div class="container">
      <div class="grid grid-3" id="coffee-grid">
        <!-- Coffee cards will be populated by JavaScript -->
      </div>
    </div>
  </section>

  <!-- About single origins -->
  <section class="section section-divider">
    <div class="container">
      <div class="grid grid-2">
        <div>
          <h2 class="text-2xl font-semibold tracking-tight text-heading mb-4">
            Why single origin?
          </h2>
          <p class="text-body mb-4">
            Single origin means coffee from one farm, one region, or one processing lot. 
            This traceability lets us understand exactly what we're working with and 
            roast to highlight the coffee's inherent characteristics.
          </p>
          <p class="text-body mb-4">
            Instead of blending different origins to create a "consistent" flavor profile, 
            we embrace the seasonal variations and unique qualities that make each harvest special.
          </p>
        </div>
        <div>
          <h3 class="text-lg font-medium mb-3">What to expect by region</h3>
          <ul class="space-y-2 text-body">
            <li><strong>East Africa:</strong> Bright acidity, floral notes, tea-like clarity</li>
            <li><strong>Central America:</strong> Clean, balanced, citrus and chocolate</li>
            <li><strong>South America:</strong> Nutty, caramel sweetness, heavier body</li>
            <li><strong>Asia Pacific:</strong> Earthy, spicy, full-bodied complexity</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact / Footer -->
  <footer id="contact" class="footer">
    <div class="container">
      <div class="footer-content">
        <p class="text-sm text-muted">© <span id="current-year"></span> Elevate Roasting • San Francisco, CA</p>
        <div class="footer-links">
          <a href="mailto:hello@elevateroasting.com" class="footer-link">
            hello@elevateroasting.com
          </a>
          <a href="#" class="footer-link" id="instagram-link">
            Instagram
          </a>
          <a href="#" class="footer-link" id="github-link">
            GitHub
          </a>
        </div>
      </div>
    </div>
  </footer>

  <!-- JavaScript modules -->
  <script src="../config/theme-config.js"></script>
  <script src="../config/site-config.js?v=4"></script>
  <script src="../js/utils.js"></script>
  <script src="../js/app.js?v=2"></script>
  
  <!-- Fallback theme initialization -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (!document.body.classList.contains('theme-light') && !document.body.classList.contains('theme-dark')) {
        document.body.classList.add('theme-light');
      }
    });
  </script>
  <script>
    // Populate coffee grid for single origin page
    document.addEventListener('DOMContentLoaded', () => {
      const populateCoffeeGrid = (retryCount = 0, maxRetries = 10) => {
        const coffeeGrid = document.getElementById('coffee-grid');
        
        // Check if we have both the DOM element and the config data
        if (coffeeGrid && window.siteConfig?.coffeeDrops) {
          try {
            const coffeeHTML = window.siteConfig.coffeeDrops.map(coffee => `
              <div class="card">
                <div class="card-image" style="background-image: url('${coffee.image}')"></div>
                <div class="card-content">
                  <h3 class="card-title">${coffee.name}</h3>
                  <p class="card-description">${coffee.description}</p>
                  <div class="mt-3 text-sm text-muted">
                    <div><strong>Origin:</strong> ${coffee.origin}</div>
                    <div><strong>Process:</strong> ${coffee.process}</div>
                    <div><strong>Elevation:</strong> ${coffee.elevation}</div>
                  </div>
                  <div class="card-footer">
                    <span class="card-price">${coffee.price}</span>
                    <button class="btn btn-small" onclick="handleCoffeeDetails('${coffee.id}')">
                      ${coffee.available ? 'Details' : 'Sold Out'}
                    </button>
                  </div>
                </div>
              </div>
            `).join('');
            coffeeGrid.innerHTML = coffeeHTML;
            return; // Success - exit the function
          } catch (error) {
            console.error('Error rendering coffee grid:', error);
            // Fall through to retry logic
          }
        }
        
        // If we reach here, either DOM element or config data is missing
        if (retryCount < maxRetries) {
          // Retry with exponential backoff, but cap the delay to prevent long waits
          const delay = Math.min(100 * Math.pow(1.5, retryCount), 1000);
          setTimeout(() => populateCoffeeGrid(retryCount + 1, maxRetries), delay);
        } else {
          // Final fallback: show error message after max retries
          console.warn('Failed to populate coffee grid after', maxRetries, 'attempts');
          const coffeeGrid = document.getElementById('coffee-grid');
          if (coffeeGrid) {
            coffeeGrid.innerHTML = '<p class="text-center text-muted">Coffee information temporarily unavailable.</p>';
          } else {
            // If DOM element still doesn't exist, log the issue
            console.error('Coffee grid DOM element not found after', maxRetries, 'attempts');
          }
        }
      };
      
      // Start the population process
      populateCoffeeGrid();
    });

    function handleCoffeeDetails(coffeeId) {
      alert(`Detailed information for coffee ${coffeeId} would be shown here.`);
    }
  </script>
</body>
</html>
